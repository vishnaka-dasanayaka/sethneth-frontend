<section class="">
  <h6 class="text-xs mb-2">
    <span
      [routerLink]="['/settings/settings-menu']"
      routerLinkActive="router-link-active"
      class="text-blue-500 cursor-pointer"
      >Settings</span
    >
    >
    <span
      [routerLink]="['/settings/user-settings']"
      routerLinkActive="router-link-active"
      class="text-blue-500 cursor-pointer"
      >User Settings</span
    >
    > User Permissions
  </h6>
  <div class="flex items-end justify-between">
    <div>
      <h1 class="text-xl font-semibold">User Level Permissions</h1>
      <h5 class="text-xs font-thin">Manage permissions for user levels</h5>
    </div>
  </div>

  <div *ngIf="!LoadUI" class="card">
    <div class="flex flex-wrap">
      <div class="w-full mt-5">
        <p-skeleton styleClass="mb-2" />
        <p-skeleton width="30rem" styleClass="mb-2" />
        <p-skeleton width="10rem" styleClass="mb-2" />
        <p-skeleton height="10rem" styleClass="mb-2" />
        <p-skeleton width="10rem" height="4rem" />
      </div>
    </div>
  </div>

  <div
    *ngIf="LoadUI"
    class="flex justify-center items-center rounded-lg h-fit mt-5 py-2 bg-gray-50"
  >
    <div class="text-xs w-72">
      <h5 class="my-1 ml-[2px]">User Level</h5>
      <p-select
        [options]="userlevels"
        [(ngModel)]="selected_user_level"
        [checkmark]="true"
        optionLabel="label"
        optionValue="value"
        [showClear]="true"
        placeholder="Select a user level"
        class="w-full"
        [filter]="true"
        (ngModelChange)="getData()"
      />
    </div>
  </div>

  <div
    *ngIf="LoadUI && selected_user_level"
    class="grid w-full grid-cols-1 md:grid-cols-2 gap-3 px-3 rounded-lg h-fit mt-5 py-2 bg-gray-50"
  >
    <div class="text-xs">
      <input
        type="text"
        [(ngModel)]="keyword"
        class="w-full px-3 py-2 border border-gray-300 placeholder:opacity-50 rounded focus:outline-none focus:ring-2 focus:ring-orange-400"
        placeholder="ðŸ” Search Permission"
        (ngModelChange)="searchPermission()"
      />
    </div>

    <div class="text-xs">
      <p-select
        [options]="permission_categories"
        [(ngModel)]="selected_permission_category"
        [checkmark]="true"
        optionLabel="label"
        optionValue="value"
        [showClear]="true"
        placeholder="Select a category"
        class="w-full"
        [filter]="true"
        (ngModelChange)="searchPermission()"
      />
    </div>
  </div>

  <div
    *ngIf="LoadUI && selected_user_level"
    class="min-h-screen mt-5 bg-gray-50 p-4"
  >
    <div *ngIf="!permission_loaded" class="card">
      <div class="flex flex-wrap">
        <div class="w-full mt-5">
          <p-skeleton styleClass="mb-2" />
          <p-skeleton width="30rem" styleClass="mb-2" />
          <p-skeleton width="10rem" styleClass="mb-2" />
          <p-skeleton height="10rem" styleClass="mb-2" />
          <p-skeleton width="10rem" height="4rem" />
        </div>
      </div>
    </div>

    <div
      *ngIf="permission_loaded"
      class="bg-white rounded-xl shadow-sm overflow-hidden"
    >
      <div
        *ngIf="filtered_permissions.length === 0"
        class="text-center text-gray-500 py-8"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="mx-auto h-10 w-10 text-gray-400"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9.75 9.75l4.5 4.5m0-4.5l-4.5 4.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
          />
        </svg>

        <p class="mt-3 text-lg font-semibold">No Matches Found</p>
        <p class="text-sm">Try adjusting your filters or keyword.</p>
      </div>

      <div
        *ngIf="filtered_permissions.length > 0"
        class="grid grid-cols-12 px-6 py-3 text-sm font-semibold text-gray-600 border-b"
      >
        <div class="col-span-5">Description</div>
        <div class="col-span-4 text-right">Status</div>
      </div>

      <!-- CATEGORY LOOP -->
      <ng-container *ngFor="let category of filtered_permissions">
        <!-- Category Title -->
        <div
          class="px-6 py-1 bg-gray-300 text-xs font-bold text-gray-500 border-b uppercase"
        >
          {{ category.perm_category }}
        </div>

        <!-- Permission Rows -->
        <ng-container *ngFor="let perm of category.permissions">
          <div
            class="grid grid-cols-12 px-6 py-2 text-sm border-b hover:bg-orange-50/40 transition"
          >
            <!-- Description -->
            <div class="col-span-5 text-gray-500">
              {{ perm.perm_desc }}
            </div>

            <!-- Status + Toggle -->
            <div class="col-span-4 flex items-center justify-end gap-3">
              <!-- Status Label -->
              <span
                class="text-xs font-semibold px-3 py-1 rounded-full"
                [ngClass]="{
                  'bg-green-100 text-green-700': perm.enabled,
                  'bg-red-100 text-red-600': !perm.enabled
                }"
              >
                {{ perm.enabled ? "ENABLED" : "DISABLED" }}
              </span>

              <!-- Toggle Switch -->
              <label class="relative inline-flex items-center cursor-pointer">
                <input
                  type="checkbox"
                  class="sr-only peer"
                  [(ngModel)]="perm.enabled"
                />
                <div
                  class="w-11 h-6 bg-gray-300 peer-focus:outline-none rounded-full peer peer-checked:bg-[#ff820d] transition-all"
                ></div>
                <div
                  class="absolute left-1 top-1 w-4 h-4 bg-white rounded-full transition-all peer-checked:translate-x-5 shadow"
                ></div>
              </label>
            </div>
          </div>
        </ng-container>
      </ng-container>
    </div>

    <!-- ACTION BUTTONS
  <div class="flex justify-end gap-4 mt-5">
    <button
      class="px-5 py-2 border border-gray-300 text-gray-600 rounded-lg hover:bg-gray-100 transition"
    >
      Cancel
    </button>

    <button
      class="px-6 py-2 bg-[#ff820d] text-white rounded-lg shadow hover:bg-[#e67000] transition"
      (click)="saveChanges()"
    >
      Save Changes
    </button>
  </div> -->
  </div>
</section>
